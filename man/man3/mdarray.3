.TH MDARRAY 3NEMO "5 May 2003"
.SH NAME
mdarray - 
.SH SYNOPSIS
.nf
.B
#include <mdarray.h>
.PP
.B #define MDMAXDIM    7 
.PP
.B typedef real     *mdarray1;   /* vector */
.B typedef mdarray1 *mdarray2;   /* matrix */
.B typedef mdarray2 *mdarray3;   /* tensor */
.B typedef mdarray3 *mdarray4;   /* hyper tensor ?? */
.B ...
.PP
.B mdarray1 allocate_mdarray1(n1)
.B mdarray2 allocate_mdarray2(n2,n1)
.B mdarray3 allocate_mdarray3(n3,n2,n1)
.B mdarray4 allocate_mdarray4(n4,n3,n2,n1)
.B ...
.fi
.SH DESCRIPTION
\fImdarray\fP offers a uniform way to allocate and free multi-dimensional
(real) arrays. Up to MDMAXDIM (defined via the header file) 
dimensions are available. 
.PP
Example of use:
.nf
    mdarray1 x = allocate_mdarray1(10);
    mdarray2 A = allocate_mdarray2(20,10);
    mdarray1 b = allocate_mdarray1(20);
    int i,j;

    for (j=0; j<20; j++) {
        b[j] = 0.0;
        for (i=0; i<10; i++)
            b[j] += A[j][i]*x[i]
    }
    
.fi

.SH CAVEATS
Although there are \fIfree_mdarrayN\fP functions available, they currently
need to know the dimensions. Looking into this.
.SH TIMING
The TESTBED function excersizes a simple initialization of all array elements, and
summing them up. This clearly shows how reversing the order of array access 
affects the CPU speed , viz. timings on a P4/1600 laptop:
.nf
    % time mdarraytest 4,4,4 iter=1000000  flip=f
    Working with ndim=3 MD_Array[[4][4][4]
    2.110u 0.010s 0:02.31 91.7%     0+0k 0+0io 135pf+0w

    % time mdarraytest 4,4,4 iter=1000000  flip=t
    Working with ndim=3 MD_Array[[4][4][4]
    2.050u 0.000s 0:02.14 95.7%     0+0k 0+0io 135pf+0w

    % time mdarraytest 100,100,100 iter=100 flip=f
    Working with ndim=3 MD_Array[[100][100][100]
    3.210u 0.020s 0:03.35 96.4%     0+0k 0+0io 135pf+0w

    % time mdarraytest 100,100,100 iter=100 flip=t
    Working with ndim=3 MD_Array[[100][100][100]
    30.530u 0.040s 0:31.85 95.9%    0+0k 0+0io 135pf+0w
.fi
On grus (P3/930) 5.0 vs. 19.9 sec.  On chand (P4/2500)  1.1 vs. 12.3 sec CPU. 
.SH SEE ALSO
.nf
vectmath(3NEMO)
.fi
Numerical Recipes's nrutil.c
.SH AUTHOR
Peter Teuben
.SH FILES
.nf
.ta +2.5i
~/src/kernel/misc	mdarray.c
.fi
.SH UPDATE HISTORY
.nf
.ta +1i +4i
5-may-03	Created   	PJT
.fi
