.TH RVSTACK 1NEMO "5 May 2021"

.SH "NAME"
rvstack \- extract Radius-Velocity diagram from a data cube for later stacking

.SH "SYNOPSIS"
\fBrvstack\fP in=cube out=map [parameter=value]

.SH "DESCRIPTION"
This program takes all points within a (narrow) cone around the major or minor
axis of an assumed galaxy disk data cube, and
construct a Radius-Velocity diagram (like a Pos-Vel diagram),
centered on the galaxy in position
and velocity.  It will properly stack the two sides of the galaxy, so the radial coordinate
will run from 0 to some Rmax.  In velocity it will run from some Vmin to some Vmax,
but always expecting positive rotation and positive outflow, assuming the
position angles are correctly set. 
.PP
Weak signal rotation and/or bulk outflow could be detected this way, but we offer no guarentee.
If you have many like-minded galaxies, stacking these images may beat the noise down much more.
.PP
Options exist to scale the Radius and Velocity to different units, such that
many galaxies can be stacked in physical space, as opposed to angular space. See
\fBrscale=\fP and \fBvscale=\fP.
.PP
You can also select to only construct the signal from one side of the galaxy. See \fBside=\fP below.
.PP
Points along an arc are all accumulated (technically: averaged), and placed on the same radial grid
as the pixel size in the input data cube. We might need some trick next neighbor smoothing
in order for pixels near the center to have a value.

.SH "PARAMETERS"
.so man1/parameters
.TP 20
\fBin=\fP\fIimage_cube\fP
input data cube, in standard \fIimage(5NEMO)\fP format. [No default]
.TP
\fBout=\fP\fIimage_map\fP
output R-V map. Not implemented yet. It currently prints out a table for inspection.
.TP
\fBpa=\fP
position angle of the receding side of disk (with mode=rotation) or
position angle of the near side of disk, or where you would expect the outflow
(for mode=outflow).
.TP
\fBinc=\fP
inclination angle of the disk [45]
.TP
\fBvsys=\fP
systemic velocity [0]   
.TP
\fBcenter=\fP\fIxpos,ypos\fP
rotation center (0,0=lower left). If not supplied, the reference pixel will be used.
Default: reference pixel.
.TP
\fBangle=\fP
small angle around major or minor axis around which points are accumulated
into the R-V plot. [Default: 10]
.TP
\fBblank=\fP
Value of the blank pixel to be ignored.
.TP
\fBrscale=\fP
Scaling factor for radius. This would be used to stack galaxies based on a KPC scaling,
or an Re scaling, not geometry, see \fBgscale=\fP below.  [Default: 1]
.TP
\fBvscale=\fP
Scaling factor for velocity. This would be  used to stack galaxies based on a mass scaling,
not geometry, see \fBgscale=\fP below. [Default: 1]
.TP
\fBgscale=f|t\fP
Scale for inclination based geometry. Rotation is scaled by 1/sin(i), outflow by 1/cos(i).
Radius is not scaled for rotation, but by 1/cos(i) for outflow.   [Default: f]
.TP
\fBmode=r|o\fP
Select output mode: rotation (r) or outflow (o).   For rotation, points around \fBpa=\fP are
selected, for outflow, points around \fBpan=\fP. [Default: r]
.TP
\fBside=0|-1|1\fP
By default it will stack both sides, but this option will allow you to stack one or the other
side. [Default: 0]

.SH "CAVEATS"
No geometric correction is made based on the angle in the disk. This could become a future
option
.PP
A wedge has the disadvantage the the noise decreases inversely proportional to the sqrt(radius)

.SH "EXAMPLES"
An example using our standard NGC 6503 cube given in km/s velocity units.

.nf
  rm junk?
  rvstack ngc6503.ccd junk1 pa=120 inc=70 vsys=27 center=164,123 rscale=3600 angle=10 mode=r
  rvstack ngc6503.ccd junk2 pa=30  inc=70 vsys=27 center=164,123 rscale=3600 angle=10 mode=o 


.fi

.SH "SEE ALSO"
ccdstack(1NEMO), image(5NEMO)

.SH "FILES"
src/image/rotcur

.SH "AUTHOR"
Peter Teuben

SH "UPDATE HISTORY"
.nf
.ta +1.0i +4.0i
5-May-21	V0.1 Draft	PJT
.fi
