<!-- manual page source format generated by PolyglotMan v3.2, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>SNAPCENTERP(1NEMO) manual page</title>
</head>
<body bgcolor='white'>
HTML automatically generated with <A HREF=http://manpages.ubuntu.com/manpages/bionic/man1/rman.1.html>rman</A><br>
<a href='#toc'>Table of Contents</a><p>

<p> 
<h2><a name='sect0' href='#toc0'>Name</a></h2>
snapcenterp - find position center of a snapshot from minimum in potential
 
<p> 
<h2><a name='sect1' href='#toc1'>Synopsis</a></h2>
<b>snapcenterp in=</b>snap-file [parameter=value] ... 
<p> 
<h2><a name='sect2' href='#toc2'>Description</a></h2>
<i>snapcenterp</i>
finds the potential center of a snapshot using the iterative Cruz et al.
(2002) method. They identified three parameters, <b>fn</b>, <b>eps</b> and <b>eta</b>, discussed
below. This algorithm is linear in <i>Nbody</i> and <i>Niter</i>. <p>
Unlike <a href='snapcenter.1.html'><i>snapcenter(1NEMO)</i></a>
,
which centers all phase space coordinates, this program only centers the
spatial coordinates, although the method could be generalized and center
the velocities. <p>
This program is still in development (see also CAVEATS below),
not all keywords are fully implemented. 
<p> 
<h2><a name='sect3' href='#toc3'>Parameters</a></h2>
 The following parameters
are recognized in order; they may be given in any order if the keyword
is also given. Use <b>--help</b> to confirm this man page is up to date.  
<dl>

<dt><b>in=</b><i>snap-file</i>
</dt>
<dd>Input data is read from <i>snap-file</i>, which must be in snapshot format. No default.
</dd>

<dt><b>out=</b><i>snap-file</i> </dt>
<dd>Output data is written to <i>snap-file</i>, which will be in snapshot
format. No default. </dd>

<dt><b>weight=</b><i>expression</i> </dt>
<dd>The value of <i>expression</i> is used to
compute the centroid. <i>expression</i> is a real-valued C language expression over
the real values <b>x</b>, <b>y</b>, <b>z</b>, <b>vx</b>, <b>vy</b>, <b>vz</b>, <b>phi</b>, <b>m</b>, <b>t</b>, and the integer value <b>i</b>.
[Default <b>m</b>]. </dd>

<dt><b>times=</b><i>time-range</i> </dt>
<dd>Only data frames with time values within <i>time-range</i>,
which is of the form, eg, "1.0:1.5,2.5,3.0", will be translated. [Default: <b>all</b>].
</dd>

<dt><b>report=t|f</b> </dt>
<dd>Report the center of mass coordinates. These are 2*NDIM numbers,
position and velocity, of the new center of mass in the old coordinates.
If you want to use <i>snapcenter</i> in a pipe, you need to reset <b>report=f</b>, since
both standard output and filestruct output will get merged, and become
illegable for the next program in the pipe. [Default: <b>t</b>]. </dd>

<dt><b>eps=</b> </dt>
<dd>Softening
length, in length units used in the snapshot. [0.025] </dd>

<dt><b>eta=</b> </dt>
<dd>Convergence stop
criterion. This number is the length of the difference  vector of two subsequent
iterations of the potential center, and is thus in units of those of the
snapshot and <b>eps</b>. [0.001] </dd>

<dt><b>fn=</b> </dt>
<dd>Fraction of particles to consider in the potential
finding algorithm [0.5]  **currently all particles used** </dd>

<dt><b>iter=</b> </dt>
<dd>Maximum
number of iterations to use. If the <b>eta</b> stop criterion did not converge,
this criterion will stop the iterations. [10] </dd>

<dt><b>center=</b><i>xc,yc,zc</i> </dt>
<dd>An estimated
center to speed up convergence. [0,0,0] </dd>

<dt><b>one=t|f</b> </dt>
<dd>Write output center of mass
(COM) as a single body with total mass and COM coordinates as computed
from <b>weight=</b>. [Default: <b>f</b>]. 
<p> </dd>
</dl>

<h2><a name='sect4' href='#toc4'>Caveats</a></h2>
Mysteriously this does not seem to work
well for small Nbody, e.g. <br>
<pre>mkplummer - 100 seed=123 | snapshift - - 0.5,0,0 | snapcenterp - . debug=1 report=t
### nemo Debug Info: 1 0.212503 -0.023019 -0.111053 0.109614
### nemo Debug Info: 2 0.229355 -0.025213 -0.162219 0.053914
### nemo Debug Info: 3 0.221806 -0.025366 -0.175827 0.015562
### nemo Debug Info: 4 0.215902 -0.017432 -0.178834 0.010336
### nemo Debug Info: 5 0.206639 -0.000181 -0.180961 0.019696
### nemo Debug Info: 6 0.193003 0.019449 -0.182329 0.023941
### nemo Debug Info: 7 0.186807 0.025474 -0.182157 0.008644
### nemo Debug Info: 8 0.186308 0.025859 -0.182110 0.000632
0.186308 0.025859 -0.182110
</pre>where the columns are iter#, pos and |r_{i+1} - r_{i}|. But clearly it is not
converging to 0.5. The larger the shift, the better the convergence. Increasing
<b>eps</b> does help, for example for eps=0.2 an ensemble of simulations with different
seeds does return the proper value within the error. See also $NEMODAT/nemoplot/shift1.tab

<p>and shift2.tab 
<p> 
<h2><a name='sect5' href='#toc5'>See Also</a></h2>
<a href='snapshift.1.html'>snapshift(1NEMO)</a>
, <a href='snapcenter.1.html'>snapcenter(1NEMO)</a>
, <a href='bodytrans.3.html'>bodytrans(3NEMO)</a>
,
<a href='snapshot.5.html'>snapshot(5NEMO)</a>
 <p>
Cruz., F et al. - (2002) Rev.Mex.de Astr.y Astr. 38, 225 <a href='https://ui.adsabs.harvard.edu/abs/2002RMxAA..38..225C'>https://ui.adsabs.harvard.edu/abs/2002RMxAA..38..225C</a>


<p> 
<h2><a name='sect6' href='#toc6'>Ads</a></h2>
@ads <A HREF=https://ui.adsabs.harvard.edu/abs/2002RMxAA..38..225C> 2002RMxAA..38..225C </A>
<p> 
<h2><a name='sect7' href='#toc7'>Author</a></h2>
Peter Teuben 
<p> 
<h2><a name='sect8' href='#toc8'>Update History</a></h2>
<br>
<pre>1-apr-06<tt> </tt>&nbsp;<tt> </tt>&nbsp;0.1 Created in Rembrandt Hotel<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
12-aug-2022<tt> </tt>&nbsp;<tt> </tt>&nbsp;0.2 cleanup up<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
16-aug-2022<tt> </tt>&nbsp;<tt> </tt>&nbsp;0.4 add (nemoplot) example<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
</pre><p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>
<li><a name='toc1' href='#sect1'>Synopsis</a></li>
<li><a name='toc2' href='#sect2'>Description</a></li>
<li><a name='toc3' href='#sect3'>Parameters</a></li>
<li><a name='toc4' href='#sect4'>Caveats</a></li>
<li><a name='toc5' href='#sect5'>See Also</a></li>
<li><a name='toc6' href='#sect6'>Ads</a></li>
<li><a name='toc7' href='#sect7'>Author</a></li>
<li><a name='toc8' href='#sect8'>Update History</a></li>
</ul>
</body>
</html>
